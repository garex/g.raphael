<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>gRaphaÃ«l Line Charts</title>
        <script src="../raphael-min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../g.raphael.js" type="text/javascript"></script>
        <script src="../g.line.js" type="text/javascript" charset="utf-8"></script>
        <script type='text/javascript' src='http://wp-testing.dev/wp/wp-includes/js/jquery/jquery.js?ver=1.11.1'></script>
<script type='text/javascript'>
jQuery(document).ready(function($) {
	var lastWidth = 0;
	var holder = $('#autosizer');
	var GOLDEN_RATIO = 1.618033988749895;
	
	function goldenHeight(width) {
		return Math.round(width/GOLDEN_RATIO);
	}
	
	function resizeMe() {
		var currentWidth = holder.width();
		if (currentWidth == lastWidth) {
			return;
		}
		console.log('resize');
		lastWidth = currentWidth;
		holder.height(goldenHeight(lastWidth));
	}
	resizeMe();
	$(window).resize(resizeMe);
});
</script>
<script type="text/javascript" charset="utf-8">window.onload = function () {
if (!Raphael.type) {
	window.holder.innerHTML = 'Unfortunately your browser is a piece of old shit. Sorry.';
	return;
}

var scaleToText = [
	'One One One One One One',
	'Two Two Two Two Two Two Two',
	'Three',
	'Four',
	'Five Five Five Five Five Five Five',
];
var scaleToAngle = [
	90 * 0,
	90 * 0,
	90 * 0,
	90 * 2,
	90 * 2,
];

var gcd = function(a,b) { return (!b)?a:gcd(b,a%b); };

var r = Raphael("holder");
this.r = r;
var lines = r.linechart(
	0, 0, 600, 370,
	[[0, 1, 2, 3, 4]], [[-10, 20, 30, 20, 10]],
	{
		gutter: 600/scaleToText.length/2,
		dash: '-',
		colors: ['#ccc'],
		symbol: "circle",
		axisxstep: 4,
		axisystep: 8,
		axis: "0 0 1 1",
		smooth: true
	});

var items = lines.axis[0].text.items;
var maxWidth = (600)/scaleToText.length - 10;
for (var i = 0, iMax = items.length; i<iMax; i++) {
	fitWidth(items[i], scaleToText[i], maxWidth);
}

function fitWidth(label, text, maxWidth) {
	var words = text.split(' ');
	var add = '';
	for (var i=words.length; i > 0; i--) {
		var current = words.join(' ') + add;
		label.attr('text', current);
		if (i == 0 || maxWidth > label.getBBox().width) {
			return;
		}
		add = '...';
		words.splice(-1, 1);
	}
}

lines.eachColumn(function() {
	this.symbols.attr({fill: Raphael.getColor(0.8)})
})

lines.hoverColumn(function () {
	this.tags = r.set();
	var tag = r.tag(this.x, this.y[0], scaleToText[this.axis] + '\n' + this.values[0], scaleToAngle[this.axis], 6)
		.insertBefore(this)
		.attr([{fill: "#fff" }, {fill: "#000"}])
	this.tags.push(tag);
}, function () {
	this.tags && this.tags.remove();
});

};</script>
    </head>
    <body style="background: gainsboro">
        <div id="holder" style="width: 600px; height: 370px; background: white;"></div>
        <div id="autosizer" style="width: 50%; min-width: 500px; max-width: 700px; height: 10px; background: green;"></div>
    </body>
</html>
